<div class="flex flex-col space-y-4">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-start">
    <!-- Original Image Upload -->
    <div class="w-full aspect-video bg-secondary border-2 border-dashed border-border rounded-lg flex items-center justify-center overflow-hidden relative">
      @if (originalImageUrl()) {
        <img [src]="originalImageUrl()" alt="Original image to be edited" class="object-cover w-full h-full" />
      } @else {
        <div class="text-center text-foreground/50 p-4">
          <svg class="mx-auto h-12 w-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0l-3 3m3-3l3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.33-2.34 3 3 0 013.75 5.25m-18 0A2.25 2.25 0 015.25 12h13.5a2.25 2.25 0 012.25 2.25v.75a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V9.75" />
          </svg>
          <p class="mt-2 text-sm">Upload an image</p>
        </div>
      }
      <input type="file" (change)="onFileSelected($event)" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" />
    </div>

    <!-- Edited Image Display -->
    <div class="w-full aspect-video bg-secondary border-2 border-dashed border-border rounded-lg flex items-center justify-center overflow-hidden">
      @if (isLoading()) {
        <div class="flex flex-col items-center justify-center text-foreground/70">
          <svg class="animate-spin h-8 w-8 text-accent mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <p class="text-sm">Editing your image...</p>
        </div>
      } @else if (editedImageUrl()) {
        <img [src]="editedImageUrl()" alt="AI-edited image" class="object-cover w-full h-full" />
      } @else {
        <div class="text-center text-foreground/50 p-4">
           <svg class="mx-auto h-12 w-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.75 18l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 14.25l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 18l-1.178.398a3.375 3.375 0 00-2.456 2.456z" /></svg>
          <p class="mt-2 text-sm">Your edited image will appear here.</p>
        </div>
      }
    </div>
  </div>

  <!-- Input Form -->
  <div class="flex items-center space-x-2">
    <input
      [(ngModel)]="prompt"
      type="text"
      placeholder="e.g., 'Add a retro filter'"
      class="flex-1 bg-secondary border border-border rounded-md px-3 py-2 text-foreground focus:ring-2 focus:ring-accent focus:outline-none"
      [disabled]="!originalImageBase64()"
    />
    <button
      (click)="editImage()"
      [disabled]="isLoading() || !prompt().trim() || !originalImageBase64()"
      class="px-4 py-2 bg-gradient-to-br from-primary-blue to-accent text-white rounded-md font-semibold hover:opacity-90 disabled:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-accent focus:outline-none">
      Edit
    </button>
  </div>

  <!-- Error message -->
  @if (error()) {
    <div class="p-3 border border-red-500/50 bg-red-500/10 rounded-md text-red-400 text-sm">
      <p><strong>Error:</strong> {{ error() }}</p>
    </div>
  }
</div>
